import{r,j as e,Y as P,y as l}from"./app-4CarAZae.js";import{P as q}from"./Pagination-CSCna3ch.js";import{A as ee,a as S,R as _}from"./AuthenticatedLayout-DlZAqirn.js";import{T as d}from"./TableHeading-2ju96-yK.js";import{S as se}from"./SearchableDropdown-BIbm-UtK.js";import{M as B}from"./Modal-DeS_P8Lr.js";import{T as A}from"./TextInput-DyNG2S4m.js";import{I as T}from"./InputError-BzZEBFuT.js";import{D as U}from"./DetailsButton-CgWO_I8Q.js";import{A as te}from"./AddButton-Cj9YlLQU.js";import{D as ae}from"./DangerButton-DgMTaCt4.js";import{S as re}from"./ScrollBar-2ExapV3B.js";import{S as de}from"./SuccessMessage-CL-2JUjC.js";import{T as le}from"./Title-Dy3FFUwd.js";import"./ApplicationLogo-Dv8uwSlW.js";import"./transition-B3zTIZ2S.js";import"./NavLink-Bq0O64v2.js";import"./DarkMode-Bf1Neqjf.js";import"./iconBase-TbwvlisU.js";import"./ResponsiveMenu-BnbI3YqC.js";import"./index-_Gq6pFcl.js";function ne({className:i="",disabled:n,children:c,...u}){const[N,b]=r.useState("bg-emerald-600");return r.useEffect(()=>{const t=setInterval(()=>{b(x=>x==="bg-blue-600"?"bg-red-600":"bg-blue-600")},500);return()=>clearInterval(t)},[]),e.jsx("button",{...u,className:`inline-flex items-center px-2 py-2 mx-1 ${N} border border-transparent rounded-md font-semibold text-lg text-white uppercase tracking-widest hover:bg-red-800 active:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150 ${n&&"opacity-25"} `+i,disabled:n,children:c})}function Ae({auth:i,center_balances:n,users:c,total_add_all:u,total_reduce_all:N,total_profit_all:b,final_balance_all:M,queryParams:t=null,message:x,success:E}){const[L,m]=r.useState(!1),[R,y]=r.useState(!1),[W,o]=r.useState(!1),[a,k]=r.useState(null),[h,v]=r.useState(0),[p,w]=r.useState(0),[F,C]=r.useState(""),[$,j]=r.useState(""),[H,f]=r.useState("");t=t||{};const Y=c.data.filter(s=>s.kind!="admin"),z=s=>{k(s),m(!0)},G=s=>{k(s),o(!0)},J=s=>{k(s),o(!0)},I=s=>{l.get(route("center-balance.index",{center_id:s.center.id}))},K=()=>{h<=0?j("القيمة يجب أن تكون أكبر من الصفر"):j(""),h>0&&(l.post(route("center-balance.store"),{user_id:a.center.id,add:h,reduce:0,profit:0,statment:F||"-"}),m(!1),C(""),v(0),j(0))},O=()=>{p<0?f("القيمة يجب أن تكون أكبر أو يساوي الصفر"):f(""),p>=0&&(l.post(route("updateBalance"),{user_id:a.center.id,addBalance:p}),y(!1),f(0),w(0))},Q=()=>{l.post(route("requestBalance"),{user_id:a.center.id}),o(!1)},V=()=>{l.post(route("cancleBalance"),{user_id:a.center.id}),o(!1)},X=s=>{Z("user_id",s.id)},Z=(s,D)=>{D?t[s]=D:delete t[s],t.page=1,l.get(route("center.balances.home"),t)},g=s=>{s===t.sort_field?t.sort_direction=t.sort_direction==="asc"?"desc":"asc":(t.sort_field=s,t.sort_direction="asc"),t.page=1,l.get(route("center.balances.home"),t)};return e.jsxs(ee,{user:i.user,message:x,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(le,{children:"أرصدة المراكز"}),e.jsx(re,{message:x})]}),children:[e.jsx(P,{title:"أرصدة المراكز"}),e.jsx(B,{show:L,onClose:()=>m(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6 dark:text-white text-gray-900",children:[e.jsxs("h2",{className:"text-lg font-medium",children:["إضافة دفعة للمركز  : ",a&&a.center.name]}),e.jsx("p",{className:"mt-4",children:"أدخل الدفعة التي تم تسديديها من قبل المركز"}),e.jsx("div",{children:e.jsx(A,{type:"number",className:"mt-4",placeholder:"المبلغ",value:h,onChange:s=>v(s.target.value)})}),e.jsx(T,{message:$,className:"mt-2"}),e.jsx("div",{children:e.jsx(A,{className:"mt-4",placeholder:"البيان",value:F,onChange:s=>{C(s.target.value)}})}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(S,{onClick:K,children:"موافق"}),e.jsx(_,{onClick:()=>(m(!1),v(0),C(""),j("")),children:"إلغاء"})]})]})}),e.jsx(B,{show:R,onClose:()=>y(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6 dark:text-white text-gray-900",children:[e.jsxs("h2",{className:"text-lg font-medium",children:["تغذية رصيد للمركز  : ",a&&a.center.name]}),e.jsx("p",{className:"mt-4",children:"أدخل الرصيد الذي تريد فتحه للمركز"}),e.jsx("div",{children:e.jsx(A,{type:"number",className:"mt-4",placeholder:"الرصيد",value:p,onChange:s=>w(s.target.value)})}),e.jsx(T,{message:H,className:"mt-2"}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(S,{onClick:O,children:"موافق"}),e.jsx(_,{onClick:()=>(y(!1),w(0),f("")),children:"إلغاء"})]})]})}),e.jsx(B,{show:W,onClose:()=>o(!1),maxWidth:"lg",children:e.jsxs("div",{className:"p-6 dark:text-white text-gray-900",children:[e.jsxs("h2",{className:"text-lg font-medium",children:["تغذية رصيد للمركز  : ",a&&a.center.name]}),e.jsxs("p",{className:"mt-4",children:["طلب المركز تغذية رصيد بقيمة : ",a&&a.center.add_balance]}),e.jsx("p",{className:"mt-4",children:"يرجى معالجة الطلب بالقبول أو الرفض"}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(S,{onClick:Q,children:"قبول"}),e.jsx(_,{onClick:V,children:"رفض"})]})]})}),e.jsx("div",{className:"py-2",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[E&&e.jsx(de,{message:E}),e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-2 text-gray-900 dark:text-gray-100",children:[e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-md font-semibold rtl:text-right text-gray-800 dark:text-gray-200",children:[e.jsx("thead",{className:"text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 border-b-2 border-gray-500",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx(d,{name:"center.name",sort_field:t.sort_field,sort_direction:t.sort_direction,sortChanged:g,children:"المركز"}),e.jsx(d,{sortable:!1,children:"المدفوعات"}),e.jsx(d,{sortable:!1,children:"الطلبات"}),e.jsx(d,{name:"final_balance",sort_field:t.sort_field,sort_direction:t.sort_direction,sortChanged:g,children:"الرصيد الصافي"}),e.jsx(d,{name:"profit",sort_field:t.sort_field,sort_direction:t.sort_direction,sortChanged:g,children:"صافي الربح"}),e.jsx(d,{sortable:!1,children:"تغذية الرصيد"}),e.jsx(d,{name:"category",sort_field:t.sort_field,sort_direction:t.sort_direction,sortChanged:g,children:"المسؤول"}),e.jsx(d,{sortable:!1,children:"التحكم"})]})}),e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 border-b-2 border-gray-500",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("th",{className:"px-3 py-3 relative",children:e.jsx(se,{items:Y,name:"user_id",selectedItem:c.data.find(s=>s.id===t.user_id),onSelectItem:X,placeholder:"اختر المركز",queryParams:t})}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"}),e.jsx("th",{className:"px-3 py-3"})]})}),e.jsx("tbody",{className:"text-center",children:n.data.map(s=>e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("td",{className:"px-3 py-2",children:s.center.name}),e.jsx("td",{className:"px-3 py-2",children:s.total_add.toLocaleString()}),e.jsx("td",{className:"px-3 py-2",children:s.total_reduce.toLocaleString()}),e.jsx("td",{className:"px-3 py-2 text-white",children:e.jsx("span",{className:`${s.final_balance_number<0?"bg-red-600":"bg-emerald-600"} rounded-md px-3 min-w-[100px] text-center inline-block font-normal`,children:s.final_balance})}),e.jsx("td",{className:"px-3 py-2",children:s.total_profit}),e.jsx("td",{className:"px-3 py-2",children:s.center.user_balance.toLocaleString()}),e.jsx("td",{className:"px-3 py-2",children:s.center.created_by.name}),e.jsx("td",{className:"px-3 py-2 text-nowrap",children:i.user.id===s.center.created_by.id?e.jsxs(e.Fragment,{children:[s.total_add===0&&s.total_reduce===0?e.jsx(U,{disabled:!0,onClick:()=>I(s),children:"عرض التفاصيل"}):e.jsx(U,{onClick:()=>I(s),children:"عرض التفاصيل"}),e.jsx(te,{onClick:()=>z(s),children:"تسديد دفعة"}),s.center.add_balance>0?e.jsx(ne,{onClick:()=>J(s),children:"معالجة طلب"}):e.jsx(ae,{onClick:()=>G(s),children:"تغذية رصيد"})]}):e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-500 mx-1",children:"ليس لديك صلاحيات"})})]},s.center.id))}),e.jsx("tfoot",{className:"text-center",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3",children:"المجموع"}),e.jsx("th",{className:"px-3 py-3",children:u}),e.jsx("th",{className:"px-3 py-3",children:N}),e.jsx("th",{className:"px-3 py-3",children:M}),e.jsx("th",{className:"px-3 py-3",children:b})]})})]})}),e.jsx(q,{links:n.links,queryParams:t})]})})]})})]})}export{Ae as default};
